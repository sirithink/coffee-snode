// Generated by CoffeeScript 1.5.0
var config, dao, log, logentries;

logentries = require('node-logentries');

config = require('../config');

dao = require('../models/BlogDao');

log = logentries.logger(config.logToken);

exports.get = function(req, res) {
  return dao.findOne({
    id: req.params.id,
    del_status: 0
  }, function(blog) {
    return dao.all({
      del_status: 0
    }, {
      only: ['id', 'title'],
      limit: 10,
      order: ['-id']
    }, function(blogs) {
      if ((blog != null) && (blogs != null)) {
        return res.render('blog', {
          title: blog.title,
          blog: blog,
          spots: blogs
        });
      } else {
        return res.render('error/404');
      }
    });
  });
};
