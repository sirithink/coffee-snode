// Generated by CoffeeScript 1.4.0
var config, dao, log, logentries;

logentries = require('node-logentries');

dao = require('../../models/BlogDao');

config = require('../../config');

log = logentries.logger(config.logToken);

exports.getAdd = function(req, res) {
  return res.render('admin/blog-add', {
    title: 'snode写博'
  });
};

exports.postAdd = function(req, res) {
  var blog;
  blog = req.body.blog;
  console.log("Add:\t" + blog.title);
  log.log("debug", "Add:\t" + blog.title);
  return dao.save(blog, function(results) {
    return res.render('admin/blog-add', {
      title: 'snode写博'
    });
  });
};

exports.getEdit = function(req, res) {
  return dao.findOne({
    id: req.params.id
  }, function(blog) {
    return res.render('admin/blog-edit', {
      title: 'snode博客编辑',
      blog: blog
    });
  });
};

exports.postEdit = function(req, res) {
  var blog;
  blog = req.body.blog;
  console.log("Updata:\t" + blog.title);
  log.log("debug", "Updata:\t" + blog.title);
  return dao.update(blog, function(results) {
    return res.redirect('admin/index');
  });
};
